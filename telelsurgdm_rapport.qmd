---
title: "TELESUR-GDM"
subtitle: "Rapport Statistique -- V1.0"
author: 
    - name: "Dr Philippe MICHEL"
      affiliations:
        name: "Hôpital NOVO"
        department: "Unité de Soutien à la Recherche Clinique"
format: 
  titlepage-pdf:
    titlepage: bg-image
    titlepage-bg-image: "novo_usrc.png"
    logo-space-after: "0\\baselineskip"
    documentclass: scrreprt
    classoption: ["oneside", "open=any, french"]
    number-sections: true
    titlepage-footer: "- **Pr Christophe PONCELET** -- Service de Gynécologie-Obstétrique -- Hôpital NOVO (Site Pontoise)\\newline - **Dr Catherine CAMPINOS** -- Service d'Endocrinologie - Diabétologie  -- Hôpital NOVO (Site Pontoise)\\newline Télésurveillance glycémique du diabète gestationnel via l’application *MyDiabby* vs le suivi classique par le carnet patient\\newline Étude rétrospective monocentrique\\newline \\today"
titlepage-theme:
    title-fontstyle: ["Huge", "bfseries"]
    title-color: novo
    subtitle-color: novo
    subtitle-fontstyle: ["huge"]
    logo-size: "0.2\\textheight"
    vrule-width: "0.1cm"
    vrule-color: novo
include-in-header:
      text: |
        \definecolor{novo}{HTML}{27484b}
        \usepackage{babel}
jss-pdf:
    keep-tex: true   
pdf-engine: lualatex
keep-tex: true
number-sections: true
toc: true
lof: true
lot: true
mainfont: Faune
mainfontoptions:
  - Numbers=OldStyle
  - Ligatures=TeX
sansfont: Myriad Pro
sansfontoptions:
  - Ligatures=TeX
fig-cap-location: bottom
tbl-cap-location: top
classoption: [french]
papersize: a4paper
editor: source
bibliography: stat.bib
cite-method: biblatex
csl: jama.csl
#reference-location: margin
#citation-location: margin
license: "CC BY-SA"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = FALSE) 
expx <- FALSE
classeur <- "telesurgdm1.xls"
```

```{r}
#| label: lib

library(baseph)
library(janitor)
library(corrplot)
library(missMDA)
library(tidyverse)
library(lubridate)
library(labelled)
library(kableExtra)
library(forestmodel)
library(epiDisplay)
library(confintr)
library(missMDA)
library(colorspace)
library(visdat)
library(gtsummary)
library(FactoMineR)
library(factoextra)
```

```{r}
#| label: import
bno <- read_csv("datas/bnom.csv")
tt <- debutph("datas/prov.csv",bno$nom)
  tt$imccalcul = bmiph(tt$imccalcul,lang = "eng" )
tt <-  tt |> 
   mutate(deltapoids = fingrospds - pds) |> 
  relocate(deltapoids, .after = fingrospds) |> 
mutate(groupe = as.factor(ifelse(as.numeric(str_sub(tt$accdte, -2))>18,"Application", "Papier")))
 
var_label(tt$deltapoids) <- "Prise de poids pendant la grossesse"


```

## Contrôle des données

L'échantillon comporte `r nrow(tt)` cas pour `r ncol(tt)` variables.

### Données manquantes

```{r}
#| label: manq
#| fig-cap: Données manquantes

vis_miss(tt, show_perc_col = TRUE)
```

## Description de la population

### La mère

```{r}
#| label: descmere
#| tbl-cap: Tableau descriptif -- Parturiente

tt |> 
  select(3:14) |> 
  tbl_summary(missing = "no") |>
  bold_labels() |> 
  add_n()
```

### L'accouchement

```{r}
#| label: descaccouch
#| tbl-cap: Tableau descriptif -- Accouchement

tt |> 
  select(16:20) |> 
  tbl_summary(missing = "no") |>
  bold_labels() |> 
  add_n()
```

### L'enfant

```{r}
#| label: descbebe
#| tbl-cap: Tableau descriptif -- Enfant

tt |> 
  select(21:22) |> 
  tbl_summary(missing = "no") |>
  bold_labels() |> 
  add_n()
```

## Critère principal

Le critère est la présence d'au moins un critère présent parmi les 14 items étudiées. 

```{r}
#| label: critp-prep

ttc <- tt |> 
  select(23:36) |> 
  mutate_all(as.numeric)
tt$total <- as.factor(ifelse(rowSums(ttc) == 14, "Pas de complication","Complication"))
var_label(tt$total) <- "Score composite"
```


